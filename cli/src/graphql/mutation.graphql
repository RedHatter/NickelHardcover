mutation InsertUserBook($object: UserBookCreateInput!) {
	insert_user_book(object: $object) {
		error
		user_book {
			id
			user_book_reads(
				where: { finished_at: { _is_null: true } }
				order_by: { started_at: desc }
				limit: 1
			) {
				id
				paused_at
				started_at
				edition {
					id
					pages
					book {
						pages
					}
				}
			}
		}
	}
}

mutation UpdateUserBook($user_book_id: Int!, $object: UserBookUpdateInput!) {
	update_user_book(id: $user_book_id, object: $object) {
		id
		error
		user_book {
			user_book_reads(
				where: { finished_at: { _is_null: true } }
				order_by: { started_at: desc }
				limit: 1
			) {
				id
				paused_at
				started_at
				edition {
					id
					pages
					book {
						pages
					}
				}
			}
		}
	}
}

mutation UpdateRead(
	$id: Int!
	$progress_pages: Int!
	$edition_id: Int!
	$started_at: date!
) {
	update_user_book_read(
		id: $id
		object: {
			edition_id: $edition_id
			started_at: $started_at
			progress_pages: $progress_pages
		}
	) {
		id
		error
	}
}

mutation InsertJournal(
	$book_id: Int!
	$edition_id: Int!
	$event: String!
	$entry: String!
	$action_at: date
	$page: Int!
	$possible: Int!
	$percent: Float!
) {
	insert_reading_journal(
		object: {
			book_id: $book_id
			edition_id: $edition_id
			event: $event
			privacy_setting_id: 1
			tags: { category: "", spoiler: false, tag: "" }
			entry: $entry
			action_at: $action_at
			metadata: {
				position: {
					type: pages
					value: $page
					possible: $possible
					percent: $percent
				}
			}
		}
	) {
		errors
		id
	}
}

mutation UpdateJournal($journal_id: Int!, $entry: String!) {
	update_reading_journal(id: $journal_id, object: { entry: $entry }) {
		errors
		id
	}
}
